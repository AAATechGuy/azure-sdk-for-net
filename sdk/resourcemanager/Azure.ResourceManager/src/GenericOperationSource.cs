// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.

// <auto-generated/>

#nullable disable

using System;
using System.Threading;
using System.Threading.Tasks;
using Azure;
using Azure.Core;
using Azure.ResourceManager;

namespace Azure.ResourceManager
{
    internal class GenericOperationSource<T> : IOperationSource<T> where T : ISerializable<T>
    {
        private readonly ArmClient _client;

        internal GenericOperationSource(ArmClient client)
        {
            _client = client;
        }

        T IOperationSource<T>.CreateResult(Response response, CancellationToken cancellationToken) =>
#if NET7_0_OR_GREATER
        T.Deserialize(response.ContentStream);
#else
        throw new InvalidOperationException("Deserialization is not supported in this version of .NET. Please upgrade to .NET 7.0 or later.");
#endif

        ValueTask<T> IOperationSource<T>.CreateResultAsync(Response response, CancellationToken cancellationToken) =>
#if NET7_0_OR_GREATER
        ValueTask.FromResult(T.Deserialize(response.ContentStream));
#else
        throw new InvalidOperationException("Deserialization is not supported in this version of .NET. Please upgrade to .NET 7.0 or later.");
#endif
    }
}
